<!-- BEGIN PAGE LEVEL STYLES -->
<link rel="stylesheet" type="text/css" href="../../assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css"/>
<link rel="stylesheet" type="text/css" href="../../assets/global/plugins/select2/select2.css"/>
<!-- END PAGE LEVEL STYLES -->
			    <!-- END PAGE HEADER 导航-->
				<div class="page-bar">
					<ul class="page-breadcrumb">
						<li>
							<i class="fa fa-home"></i>
							<a href="index">Home</a>
							<i class="fa fa-angle-right"></i>
						</li>
						<li>
							<a href="#">冰箱小贴士</a>
						</li>
					</ul>
					<div class="page-toolbar"></div>
				</div>
				<!-- END PAGE HEADER 导航-->

				<!-- BEGIN PAGE CONTENT-->
				<div class="row">
					<div class="col-md-12">
						<!-- BEGIN EXAMPLE TABLE PORTLET-->
						<div class="portlet box blue">
							<div class="portlet-title">
								<div class="caption">
									<i class="fa fa-edit"></i>小贴士信息编辑
								</div>
								<div class="tools">
									<a href="javascript:;" class="reload"></a>
								</div>
							</div>
							<div class="portlet-body">
								<!-- START 表格工具栏 -->
								<div class="table-toolbar">
									<div class="row">
										<!--增加，查询-->
										<div class="col-md-2">
											<div class="btn-group">
												<a data-toggle="modal" class="btn green" role="button" href="#myModal_addTips">新 增 <i class="fa fa-plus"></i> </a>
											</div>	
										</div>
										<input type="hidden" id="s_tipsType" value="$!{s_tipsType}"/>
										<div class="col-md-2">
											<input id="s_tipsName" name="s_tipsName" type="text" placeholder="小贴士名字" class="form-control" value="$!{s_tipsName}"/>
										 </div>
										<div class="col-md-2">
											<select id="s_goodsId" name="s_goodsId" class="form-control select2 input-min" placeholder="食品名称">
												<option value="" selected >--食品名称--</option>
												#foreach($param in ${goodsMap.keySet()}) 
													#if($param==$!{s_goodsId})
														<option value="$param" selected >${goodsMap.get($param)}</option>
													#else
													  <option value="$param">${goodsMap.get($param)}</option>		
													#end
												#end 
											</select>
										 </div>
										<div class="col-md-2">
											<div class="btn-group">
												<a class="btn yellow" href="javascript:;" onclick="tipsJS.search();">
													查询
													<i class="fa fa-search"></i>
												</a>		
											</div>	
										</div>
										<!--导出工具-->
										<div class="col-md-4">
											<div class="btn-group pull-right">
												<button class="btn dropdown-toggle" data-toggle="dropdown">导 出 <i class="fa fa-angle-down"></i>
												</button>
												<ul class="dropdown-menu pull-right">
													<li>
														<a href="javascript:;">
														打印 </a>
													</li>
													<li>
														<a href="javascript:;">
														导出为PDF </a>
													</li>
													<li>
														<a href="javascript:;">
														导出为Excel </a>
													</li>
												</ul>
											</div>
										</div>
									</div>
								</div>
								<!-- END 表格工具栏 -->
								
								
								<!-- START 表格数据 -->
								<table class="table table-striped table-hover table-bordered" id="list_table">
								<thead>
								<tr>
									<th width="150px">
										 小贴士名字
									</th>
									<th width="100px">
										 小贴士类型
									</th>
									<th width="120px">
										 食品名称(区域)
									</th>
									<th width="80px">
										 食品ID
									</th>
									<th width="220px">
										 CMS KEY
									</th>
									<th width="150px" style="text-align:center">
										 修改日期
									</th>
									<th colspan="2" style="text-align:center">					
										 操作
									</th>
								</tr>
								</thead>
								<tbody>
							     #foreach($item in ${listPage.getResult()})
									<tr id="tr_$!{item.id}" style="padding:2px;font-size:12px">
										<td name="tipsName" style="word-break:break-all;text-align:left;">$!{item.tipsName}</td>
										<td name="tipsType"  style="word-break:break-all;text-align:left;">#if($!{item.tipsType}==2) 食品小贴士  #elseif($!{item.tipsType}==1) 系统小贴士  #else 常用小贴士 #end</td>			
										<td name="goodsName"  style="word-break:break-all;text-align:left;">$!{velocityMapTool.getMapValue($goodsMap,$!{item.goodsId})}</td>
										<td name="goodsId"  style="word-break:break-all;text-align:left;">$!{item.goodsId}</td>
										<td name="cmsKey"  style="word-break:break-all;text-align:left;">$!{item.cmsKey}</td>
										<td style="text-align: center;">$dateTool.format('yyyy-MM-dd HH:mm:ss',$!{item.modifyDate}) </td>
										<td style="text-align:center;"><a class="btn green btn-sm" role="button" onclick="tipsJS.update(this,$!{item.id});">修 改 <i class="fa fa-edit"></i> </a></td>
										<td style="text-align:center;"><a class="btn red btn-sm"   role="button" onclick="tipsJS.del($!{item.id});">删 除<i class="fa fa-trash-o"></i> </a></td>
								    </tr>
							     #end	
								</tbody>
								</table>				
								 #parse("tips/listPage.vm")
								
							</div>
						</div>
						<!-- END EXAMPLE TABLE PORTLET-->
					</div>
				</div>
				<!-- END PAGE CONTENT -->
				<div class="clearfix">
				</div>				

<!-- 
模态窗口 显示时候
class="modal fade in" aria-hidden="false" role="dialog" style="display: block; padding-right: 17px;"
-->				
				
<div id="myModal_addTips" class="modal fade" role="dialog" aria-hidden="true"  data-backdrop="static" >
	<div class="modal-dialog">
		<div class="modal-content">
											<div class="modal-header">
												<button type="button" class="close" data-dismiss="modal" aria-hidden="true"   ></button>
												<h4 class="modal-title">新增小贴士</h4>
											</div>
											<div class="modal-body form">
												<form id="form_add"action="#" class="form-horizontal form-row-seperated">
													<div class="form-group">
														<label class="col-sm-4 control-label">小贴士名字</label>
														<div class="col-sm-8">
															<div class="input-group">
																<span class="input-group-addon">
																<i class="fa fa-cutlery"></i>
																</span>
																<input type="text" id="tipsName" name="tipsName" class="form-control input-medium"/>
															</div>
															<p class="help-block">
																例如:苹果，桔子<br>
															</p>
														</div>
													</div>
													<div class="form-group">
														<label class="col-sm-4 control-label"> 小贴士类型</label>
														<div class="col-sm-8">
															<div class="input-group">
																<span class="input-group-addon">
																<i class="fa fa-cogs"></i>
																</span>
																<select id="tipsType" name="tipsType" class="form-control select2 input-medium">
																	<option value="2">食品小贴士</option>
																	<option value="3">常用小贴士 </option>
																	<option value="1">系统小贴士 </option>
																</select>
															</div>
															<p class="help-block">
																 例如: 系统小贴士  1;食品小贴士 2;常用小贴士 3</code>
															</p>
														</div>
													</div>
													
													<div class="form-group">
														<label class="col-sm-4 control-label">食品</label>
														<div class="col-sm-8">
															<div class="input-group">
																<span class="input-group-addon">
																<i class="fa fa-flag"></i>
																</span>

																<select id="goodsId" name="goodsId" class="form-control select2 input-medium">
																	#foreach($param in ${goodsMap.keySet()}) 
																		<option value="$param">${goodsMap.get($param)}</option>																		
																	#end 
															   </select>
															</div>
															<p class="help-block">
																 </code>
															</p>
														</div>
													</div>
													
													

													<div class="form-group last">
														<label class="col-sm-4 control-label">CMS KEY</label>
														<div class="col-sm-8">
															<div class="input-group">
																<span class="input-group-addon">
																<i class="fa fa-flag "></i>
																</span>
																<input type="text" id="cmsKey" name="cmsKey" class="form-control input-medium"/>
															</div>
															<p class="help-block">
																  CMS KEY:cms管理系统查找
															</p>
														</div>
													</div>
												</form>
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-default" data-dismiss="modal">取 消</button>
												<button type="button" class="btn btn-primary" onclick="tipsJS.addSave('form_add')"><i class="fa fa-check"></i>保 存</button>
											</div>
		</div>
	</div>
</div>

<div id="myModal_updateTips" class="modal fade" role="dialog" aria-hidden="true"  data-backdrop="static" >
	<div class="modal-dialog">
		<div class="modal-content">
											<div class="modal-header">
												<button type="button" class="close" data-dismiss="modal" aria-hidden="true"   ></button>
												<h4 class="modal-title">修改小贴士</h4>
											</div>
											<div class="modal-body form">
												<form id="form_update" action="#" class="form-horizontal form-row-seperated">
													<input type="hidden" id="id" name="id" />
													<div class="form-group">
														<label class="col-sm-4 control-label">小贴士名字</label>
														<div class="col-sm-8">
															<div class="input-group">
																<span class="input-group-addon">
																<i class="fa fa-cutlery"></i>
																</span>
																<input type="text" id="tipsName" name="tipsName" class="form-control input-medium" />
															</div>
															<p class="help-block">
																例如:苹果，桔子<br>
															</p>
														</div>
													</div>
													<div class="form-group">
														<label class="col-sm-4 control-label"> 小贴士类型</label>									
														<div class="col-sm-8">
															<div class="input-group">
																<span class="input-group-addon">
																<i class="fa fa-cogs"></i>
																</span>
																<input type="text" id="tipsType" name="tipsType" class="form-control input-medium" disabled />										
															</div>
															<p class="help-block">
																 例如: 系统小贴士  1;食品小贴士 2;常用小贴士 3</code>
															</p>
														</div>
													</div>
													
													<div class="form-group">
														<label class="col-sm-4 control-label">食品名称</label>
														<div class="col-sm-8">
															<div class="input-group">
																<span class="input-group-addon">
																<i class="fa fa-flag"></i>
																</span>
																<input type="text" id="goodsName" name="goodsName" class="form-control input-medium" disabled/>
															</div>
															<p class="help-block">
																 </code>
															</p>
														</div>
													</div>
													
													
													<div class="form-group last">
														<label class="col-sm-4 control-label">CMS KEY</label>
														<div class="col-sm-8">
															<div class="input-group">
																<span class="input-group-addon">
																<i class="fa fa-flag "></i>
																</span>
																<input type="text" id="cmsKey" name="cmsKey" class="form-control input-medium" />
															</div>
															<p class="help-block">
																  CMS KEY:cms管理系统查找
															</p>
														</div>
													</div>
												</form>
											</div>
											<div class="modal-footer">
												<button type="button" class="btn btn-default" data-dismiss="modal">取 消</button>
												<button type="button" class="btn btn-primary" onclick="tipsJS.updateSave('form_update')"><i class="fa fa-check"></i>保 存</button>
											</div>
		</div>
	</div>
</div>
<!-- BEGIN PAGE LEVEL PLUGINS -->
<script type="text/javascript" src="../../assets/global/plugins/select2/select2.min.js"></script>
<!-- END PAGE LEVEL PLUGINS -->
<!-- BEGIN PAGE LEVEL SCRIPTS -->
<script src="/js/tips/listPage.js" type="text/javascript"></script>
<script src="/js/tips/tips.js" type="text/javascript"></script>
<script>
//输入限制
jQuery(document).ready(function() {  
  //上面是keyup事件处理,下面处理了CTR+V事件,最后就是CSS设置输入法不可用
  //已经修改为select，不再需要
  $("input[id='goodsId']").each(function(){
  
       $(this).css("ime-mode", "disabled");//输入法禁止

       $(this).keydown(function (e) { 
              var code = parseInt(e.keyCode);  
              if (code >= 96 && code <= 105 || code >= 48 && code <= 57 || code == 8) {  
                   return true;  
              } else {  
                   return false;  
              }  
        });  
        $(this).keyup(function (e) { 
           var tmptxt=$(this).val();       
           $(this).val(tmptxt.replace(/\D|^0/g,''));   
        });  
		
		$(this).bind("paste",function(){       
           var tmptxt=$(this).val();       
           $(this).val(tmptxt.replace(/\D|^0/g,''));       
        });
		
		$(this).bind("blur", function() {       
                if (this.value.lastIndexOf(".") == (this.value.length - 1)) {       
                    this.value = this.value.substr(0, this.value.length - 1);       
                } else if (isNaN(this.value)) {       
                    this.value = "";       
                }       
         }); 
		
  
  });
  //初始化select
  $("select[id='s_goodsId']").select2({
            placeholder: "Select a Country",
            allowClear: true,
            escapeMarkup: function (m) {
                return m;
            }
   });
  $("select[id='goodsId']").select2({
            placeholder: "Select a Country",
            allowClear: true,
            escapeMarkup: function (m) {
                return m;
            }
   });   
  $("select[id='tipsType']").each(function(){  

    $(this).select2({
            placeholder: "Select a Country",
            allowClear: true,
            escapeMarkup: function (m) {
                return m;
            }
    });
  
  });
   
   

});
</script>